{% extends "base.html" %}
{% block title %}Search{% endblock %}

{% block content %}
<h2>Search</h2>

<form action="{{ url_for('search') }}" method="get">
  <label for="q">Keywords</label>
  <input id="q" type="text" name="q" value="{{ q or '' }}" placeholder="Try: airpods">

  <label for="status">Status</label>
  <select id="status" name="status">
    <option value="" {{ '' == (status or '') and 'selected' or '' }}>Any status</option>
    <option value="lost" {{ (status or '') == 'lost' and 'selected' or '' }}>Lost</option>
    <option value="found" {{ (status or '') == 'found' and 'selected' or '' }}>Found</option>
    <option value="resolved" {{ (status or '') == 'resolved' and 'selected' or '' }}>Resolved</option>
  </select>

  <button type="submit" class="tab">Search</button>
</form>

{% if items is defined %}
  <h3>Results ({{ items|length }})</h3>

  {% if items|length == 0 %}
    <p>No matches.</p>
  {% else %}
    <ul>
      {% for it in items %}
        <li style="margin-bottom:12px">
          <a href="{{ url_for('detail', post_id=it.sid, back=url_for('search', q=q, status=status)) }}">
            <strong>{{ it.title }}</strong>
          </a>
          — {{ it.status|default('unknown') }}
          @ {{ it.location|default('unspecified') }}
          {% if it.created_at %} • {{ it.created_at.strftime('%Y-%m-%d %I:%M %p') }}{% endif %}
          {% if it.description %}<br><small>{{ it.description }}</small>{% endif %}
        </li>
      {% endfor %}
    </ul>
  {% endif %}
{% endif %}
{% endblock %}
